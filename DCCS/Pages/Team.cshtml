@page "{teamid:int}/{handler?}"
@model DCCS.Pages.TeamModel
@{
    ViewData["Title"] = "Team Page";
}
@section Scripts {
    <partial name="_Loader" />
}
<div class="loader"></div>

<div class="team-title">
    <div><img src="/image/team_logo/@(Model.teamName).png"></div>
    <div class="team-name">@Model.teamName</div>
</div>

@if(Model.teamMembers.Count <= 5)
{
    <div class="team-display-5">
        @foreach (var member in Model.teamMembers)
        {
            <div class="team-player">
                <div class="picture">
                    <div class="profile-picture">
                        <img src="/image/picture/@(member.DiscordId).png" alt="Profile Picture">
                        <div class="shape"></div>
                    </div>
                </div>
                <div class="ign"><a class="nav-link" asp-area="" asp-page="/Profile" asp-route-userid="@member.DiscordId">@member.Ign</a></div>
            </div>
        }
    </div>
} else if (Model.teamMembers.Count == 6)
{
    <div class="team-display-6">
        @foreach (var member in Model.teamMembers)
        {
            <div class="team-player">
                <div class="picture">
                    <div class="profile-picture">
                        <img src="/image/picture/@(member.DiscordId).png" alt="Profile Picture">
                        <div class="shape"></div>
                    </div>
                </div>
                <div class="ign"><a class="nav-link" asp-area="" asp-page="/Profile" asp-route-userid="@member.DiscordId">@member.Ign</a></div>
            </div>
        }
    </div>
} else if (Model.teamMembers.Count == 7)
{
    <div class="team-display-7">
        @foreach (var member in Model.teamMembers)
        {
            <div class="team-player">
                <div class="picture">
                    <div class="profile-picture">
                        <img src="/image/picture/@(member.DiscordId).png" alt="Profile Picture">
                        <div class="shape"></div>
                    </div>
                </div>
                <div class="ign"><a class="nav-link" asp-area="" asp-page="/Profile" asp-route-userid="@member.DiscordId">@member.Ign</a></div>
            </div>
        }
    </div>
}

@if (Model.captain) {
    <div class="page-title" style="margin-top: 50px">Edit</div>
    <div class="teampage-editrow-header">
        <div style="width: 20%">IGN</div>
        <div style="width: 20%">Status</div>
        <div style="width: 40%">Change Status</div>
        <div style="width: 20%">Kick</div>
    </div>

    @foreach (var member in Model.teamMembers)
    {
        <div class="teampage-editrow">
            <div style="width: 20%">@member.Ign</div>
            <div style="width: 20%">@member.Status</div>
            <form method="post" enctype="multipart/form-data" asp-page-handler="ChangeStatus" class="changestatus">
                <div>
                    <select id="role_input" asp-for="status">
                        <option value="-">-</option>
                        <option value="Local">Local</option>
                        <option value="External">External</option>
                    </select>
                </div>
                <div>
                    <input type="hidden" name="buttonValue1" value="@member.DiscordId">
                    <button type="submit" class="submit-button">Change Status</button>
                </div>
            </form>
            @if (member.DiscordId != Model.captainId)
            {
                <form method="post" enctype="multipart/form-data" asp-page-handler="Kick" style="width: 20%">
                    <input type="hidden" name="buttonValue" value="@member.DiscordId">
                    <button type="submit" class="submit-button-red">Kick</button>
                </form>
            }
        </div>
    }

    <div class="page-title" style="margin-top: 50px">Invite Players</div>

    <form method="post" enctype="multipart/form-data" asp-page-handler="Invite">
        <div class="label">Select a player <span class="form-fail">(players without a profile or already in a team are not listed)</span></div>
        <div class="teampage-invite">
            <select id="role_input" asp-for="discordId">
                <option value="-">-</option>
                @foreach (var user in Model.users)
                {
                    <option value="@user.DiscordId">@user.Ign</option>
                }
            </select>
            <button type="submit" class="submit-button" style="width: auto;">Send an invite</button>
        </div>
    </form>

    <div class="page-title" style="margin-top: 50px">Delete Team</div>

    <form method="post" enctype="multipart/form-data" asp-page-handler="Delete">
        <input name="buttonValue" class="form-control" style="width: 50%" placeholder="Enter the following to confirm: @Model.teamName">
        <button type="submit" class="submit-button-red">Delete Team</button>
        <div class="form-fail">@Html.ValidationMessage("rulebook")</div>
    </form>
}